import{socksDispatcher as g}from"fetch-socks";import{HttpsProxyAgent as $}from"https-proxy-agent";import{SocksProxyAgent as m}from"socks-proxy-agent";import{ProxyAgent as w}from"undici";function O(r){let t=new URL(r),o="http:",n="socks:",c="socks5:";switch(t.protocol){case o:return new $(t);case n:case c:{let s="";return t.username&&t.password?s=`socks://${t.username}:${t.password}@${t.hostname}:${t.port}`:s=`socks://${t.hostname}:${t.port}`,new m(s)}default:throw new Error(`Unsupported proxy protocol: ${t.protocol}`)}}function R(r){if(typeof r=="string")return O(r);let{host:t,password:o,port:n,protocol:c,username:s}=r,i=`${c}://${t}:${n}`;return s&&o&&(i=`${c}://${s}:${o}@${t}:${n}`),O(i)}function k(r){let t,o;if(typeof r=="string")o=new URL(r).protocol.replace(":",""),t=r;else{let{host:p,password:e,port:P,protocol:u,username:a}=r;o=(u||"http").replace(":",""),o==="socks"&&(o="socks5");let l=a&&e?`${a}:${e}@`:"";t=`${o}://${l}${p}:${P}`}o=o.toLowerCase();let n="http",c="https",s="socks4",i="socks5";switch(o){case n:case c:return new w(t);case s:case i:{let p=5;s===o&&(p=4);let e=new URL(t);return g({type:p,host:e.hostname,port:Number(e.port),userId:e.username||void 0,password:e.password||void 0})}default:throw new Error(`Unsupported proxy protocol: ${o}`)}}export{R as makeProxyAgent,k as makeProxyAgentUndici};
//# sourceMappingURL=makeProxyAgent.mjs.map