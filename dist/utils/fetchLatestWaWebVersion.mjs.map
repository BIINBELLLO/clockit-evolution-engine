{"version":3,"sources":["../../src/utils/fetchLatestWaWebVersion.ts"],"sourcesContent":["import axios, { AxiosRequestConfig } from 'axios';\nimport { fetchLatestBaileysVersion, WAVersion } from 'baileys';\n\nexport const fetchLatestWaWebVersion = async (options: AxiosRequestConfig<{}>) => {\n  try {\n    const { data } = await axios.get('https://web.whatsapp.com/sw.js', {\n      ...options,\n      responseType: 'json',\n    });\n\n    const regex = /\\\\?\"client_revision\\\\?\":\\s*(\\d+)/;\n    const match = data.match(regex);\n\n    if (!match?.[1]) {\n      return {\n        version: (await fetchLatestBaileysVersion()).version as WAVersion,\n        isLatest: false,\n        error: {\n          message: 'Could not find client revision in the fetched content',\n        },\n      };\n    }\n\n    const clientRevision = match[1];\n\n    return {\n      version: [2, 3000, +clientRevision] as WAVersion,\n      isLatest: true,\n    };\n  } catch (error) {\n    return {\n      version: (await fetchLatestBaileysVersion()).version as WAVersion,\n      isLatest: false,\n      error,\n    };\n  }\n};\n"],"mappings":"AAAA,OAAOA,MAAmC,QAC1C,OAAS,6BAAAC,MAA4C,UAE9C,IAAMC,EAA0B,MAAOC,GAAoC,CAChF,GAAI,CACF,GAAM,CAAE,KAAAC,CAAK,EAAI,MAAMJ,EAAM,IAAI,iCAAkC,CACjE,GAAGG,EACH,aAAc,MAChB,CAAC,EAEKE,EAAQ,mCACRC,EAAQF,EAAK,MAAMC,CAAK,EAE9B,OAAKC,IAAQ,CAAC,EAYP,CACL,QAAS,CAAC,EAAG,IAAM,CAHEA,EAAM,CAAC,CAGM,EAClC,SAAU,EACZ,EAdS,CACL,SAAU,MAAML,EAA0B,GAAG,QAC7C,SAAU,GACV,MAAO,CACL,QAAS,uDACX,CACF,CASJ,OAASM,EAAO,CACd,MAAO,CACL,SAAU,MAAMN,EAA0B,GAAG,QAC7C,SAAU,GACV,MAAAM,CACF,CACF,CACF","names":["axios","fetchLatestBaileysVersion","fetchLatestWaWebVersion","options","data","regex","match","error"]}